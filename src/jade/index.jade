include partials/mixins

doctype html
html(ng-app='mainApp')
	include partials/head
	body(ng-cloak ng-controller='MainCtrl')
		.container
			h2 Single Transferable Vote Calculator
			h5 A better way of voting
			include partials/navbar
			.panel.panel-default(ng-show="activeLink == 'register'")
				.panel-body
					include pages/register.html
			.panel.panel-default(ng-show="activeLink == 'home'")
				.panel-body
					include pages/home
			.panel.panel-default(ng-show="activeLink == 'about'")
				.panel-body
					include pages/about
			.panel.panel-default(ng-show="activeLink != 'about' && activeLink != 'home'")
				.panel-body
					a.hidden(href='#' ng-click='signOut()') Sign out
					.g-signin2.hidden(data-onsuccess='onSignIn')
					div(ng-hide="thanks || congrats")
						div(ng-hide="voteBallot || createBallot || resultsBallot || editBallot")
							button.btn.btn-primary(ng-click="voteBallot = true") Vote
							button.btn.btn-success(ng-click="createBallot = true; generateRandomKey()") Create New Ballot
							button.btn.btn-info(ng-click="editBallot = true") Edit Ballot
						div(ng-show="editBallot")
							select.form-control(ng-model="ballot" ng-options="item as item.name for item in allBallots track by item.id" ng-change="changeEditBallot()")
						h1 Ballot: {{ballot.name}}
						div(ng-show="createBallot")
							include partials/form
							div(ng-show='updated && !candidates')
								include partials/new-entries
						div(ng-if='candidates')
							h2 Order by Preference
							h3 {{ballot.positions}} position{{ballot.positions == 1 ? "" : "s"}} available
							form(name='voteForm' ng-submit='submitVote()')
								ul#sortable(ui-sortable ng-model='candidates')
									li(ng-repeat='item in candidates track by $index') {{item}}
										i.fa.fa-close(ng-click="removeCandidate($index)")
								button.btn.btn-primary.clearfix(type='submit') Vote!
								button.btn.btn-default(type="button" ng-click='resetCandidates()') Reset
					div(ng-show="congrats")
						include partials/congrats
					div(ng-show="thanks || final")
						h3(ng-hide="final") Thank you for voting!
						button.btn.btn-primary(ng-click="getResults()" ng-hide="final") See Results
						div(ng-show="final")
							h2 The winner{{elected.length == 1 ? "" : "s"}}:
								span(ng-repeat="result in elected")  {{result}}
									span(ng-if="!$last") ,&nbsp;
							button.btn.btn-default.hidden-xs(ng-click="showText = !showText") {{!showText ? "Show" : "Hide"}} details
					table(ng-hide="true")
						tr(ng-repeat="x in names")
							td {{x.Name}}
							td {{x.Country}}
					div(ng-show="showText" ng-bind-html="bodyText")
		@@javascriptReplaceFiles